MozNSS: cipher suite selection by name may be ignored

Author: Tim Strobell <tim.strobell.ctr@nrl.navy.mil>
Upstream ITS: #7289
Upstream commit: 4b6bd2c600a79960409499f43a818aa0ca9fe463
Resolves: #825875 (CVE-2012-2668)

---
 libraries/libldap/tls_m.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libraries/libldap/tls_m.c b/libraries/libldap/tls_m.c
index 4c18360..d71fec7 100644
--- a/libraries/libldap/tls_m.c
+++ b/libraries/libldap/tls_m.c
@@ -624,7 +624,7 @@ nss_parse_ciphers(const char *cipherstr, int cipher_list[ciphernum])
 			} else {
 				for (i=0; i<ciphernum; i++) {
 					if (!strcmp(ciphers_def[i].ossl_name, cipher) &&
-						cipher_list[1] != -1)
+						cipher_list[i] != -1)
 						cipher_list[i] = action;
 				}
 			}
-- 
1.7.10.4

