--- openldap-2.3.43/clients/tools/common.c.orig	2009-10-19 20:29:56.000000000 +0200
+++ openldap-2.3.43/clients/tools/common.c	2009-10-19 20:34:27.000000000 +0200
@@ -959,6 +959,7 @@ tool_conn_setup( int not, void (*private
 void
 tool_bind( LDAP *ld )
 {
+	int rc;
 #ifdef LDAP_CONTROL_PASSWORDPOLICYREQUEST
 	if ( ppolicy ) {
 		LDAPControl *ctrls[2], c;
@@ -975,7 +976,6 @@ tool_bind( LDAP *ld )
 	if ( authmethod == LDAP_AUTH_SASL ) {
 #ifdef HAVE_CYRUS_SASL
 		void *defaults;
-		int rc;
 
 		if( sasl_secprops != NULL ) {
 			rc = ldap_set_option( ld, LDAP_OPT_X_SASL_SECPROPS,
@@ -1027,11 +1027,17 @@ tool_bind( LDAP *ld )
 			exit( EXIT_FAILURE );
 		}
 
-		if ( ldap_result( ld, msgid, 1, NULL, &result ) == -1 ) {
+		rc = ldap_result( ld, msgid, 1, NULL, &result );
+		if ( rc == -1 ) {
 			ldap_perror( ld, "ldap_result" );
 			exit( EXIT_FAILURE );
 		}
 
+		if ( rc == 0 ) {
+			ldap_perror( ld, "ldap_result timeout" );
+			exit( EXIT_FAILURE );
+		}
+
 		if ( ldap_parse_result( ld, result, &err, &matched, &info, &refs,
 			&ctrls, 1 ) != LDAP_SUCCESS )
 		{
